---
layout: false
---
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>èƒ–å“¥ç¾å‘³å°ç‚’åº—</title>
    <style>
        :root {
            --primary-color: #D32F2F; /* å“ç‰Œçº¢ */
            --accent-color: #FFC107;  /* å“ç‰Œé»„ */
            --text-dark: #333;
            --text-light: #888;
            --bg-gray: #f5f5f5;
            --white: #ffffff;
            --sidebar-bg: #f7f8fa;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body, html {
            height: 100%;
            overflow: hidden;
            background-color: var(--white);
        }

        /* === é¡¶éƒ¨åŒºåŸŸ === */
        .header-container {
            height: 96px;
            background: white;
            z-index: 10;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        }

        .header-title {
            height: 46px;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .header-subtitle {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-left: 10px;
            font-weight: normal;
        }

        .search-bar {
            height: 50px;
            display: flex;
            align-items: center;
            padding: 0 15px;
        }

        .search-input {
            flex: 1;
            height: 32px;
            background-color: #f2f2f2;
            border: none;
            border-radius: 16px;
            padding: 0 35px 0 15px;
            font-size: 0.9rem;
            outline: none;
            /* ç®€å•çš„SVGæœç´¢å›¾æ ‡ */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='18' height='18' fill='%23999'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
        }

        /* === ä¸»ä½“å¸ƒå±€ (å·¦å³åˆ†æ ) === */
        .main-container {
            display: flex;
            height: calc(100% - 96px - 50px); /* å‡å»é¡¶éƒ¨å’Œåº•éƒ¨æ é«˜åº¦ */
        }

        /* å·¦ä¾§ä¾§è¾¹æ  */
        .sidebar {
            width: 86px;
            background-color: var(--sidebar-bg);
            overflow-y: auto;
        }

        .nav-item {
            padding: 16px 8px;
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            position: relative;
            cursor: pointer;
        }

        .nav-item.active {
            background-color: var(--white);
            color: var(--text-dark);
            font-weight: 700;
        }
        
        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background-color: var(--primary-color);
            border-radius: 0 2px 2px 0;
        }

        /* å³ä¾§å†…å®¹ */
        .content {
            flex: 1;
            overflow-y: auto;
            position: relative;
            padding: 0 12px;
            scroll-behavior: smooth;
        }

        .category-header {
            font-size: 0.9rem;
            color: #333;
            font-weight: bold;
            padding: 15px 0 10px 0;
            background: rgba(255,255,255,0.95);
            position: sticky;
            top: 0;
            z-index: 5;
            backdrop-filter: blur(5px);
        }

        /* èœå“å¡ç‰‡ */
        .dish-item {
            display: flex;
            margin-bottom: 20px;
        }

        .dish-img-box {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            flex-shrink: 0;
            background-color: #fce4ec;
        }

        .dish-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 2px 0;
        }

        .dish-name {
            font-size: 1rem;
            font-weight: 600;
            color: #222;
            line-height: 1.2;
        }
        
        .dish-tag {
            font-size: 0.7rem;
            color: #999;
            margin-top: 4px;
            background: #f5f5f5;
            padding: 1px 4px;
            border-radius: 4px;
            display: inline-block;
            align-self: flex-start;
        }

        .dish-action {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .dish-price {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.15rem;
            display: flex;
            align-items: baseline;
        }
        
        .dish-price span {
            font-size: 0.8rem;
            margin-right: 1px;
        }

        /* æŒ‰é’®ç»„ä»¶ */
        .btn-add {
            width: 26px;
            height: 26px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            border: none;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(211,47,47,0.2);
        }

        .qty-control {
            display: flex;
            align-items: center;
        }
        
        .btn-minus {
            width: 26px;
            height: 26px;
            background-color: white;
            color: #333;
            border: 1px solid #ddd;
            border-radius: 50%;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 0.8;
            cursor: pointer;
        }

        .qty-num {
            width: 32px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* === åº•éƒ¨è´­ç‰©è½¦æ  === */
        .cart-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background-color: #222;
            z-index: 100;
            display: flex;
            align-items: center;
            padding-left: 80px;
        }

        .cart-icon-wrapper {
            position: absolute;
            left: 15px;
            top: -15px;
            width: 50px;
            height: 50px;
            background-color: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid #444;
            transition: all 0.3s;
        }
        
        .cart-icon-wrapper.active {
            background-color: var(--accent-color);
            border-color: #222;
            color: #222;
        }

        .cart-icon {
            font-size: 1.5rem;
            color: #666;
        }
        
        .cart-icon-wrapper.active .cart-icon {
            color: #222;
        }

        .cart-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background-color: var(--primary-color);
            color: white;
            font-size: 0.65rem;
            min-width: 16px;
            height: 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid white;
            display: none;
        }

        .total-price {
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .delivery-text {
            color: #999;
            font-size: 0.7rem;
            margin-left: 5px;
        }

        .btn-checkout {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 110px;
            background-color: #444;
            color: #999;
            border: none;
            font-weight: bold;
            font-size: 1rem;
            cursor: not-allowed;
        }
        
        .btn-checkout.active {
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
        }

        /* === è´­ç‰©è½¦è¯¦æƒ…å¼¹çª— (åº•éƒ¨æ»‘å‡º) === */
        .modal-mask {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 90;
            display: none;
            backdrop-filter: blur(2px);
        }

        .cart-popup {
            position: fixed;
            bottom: 50px;
            left: 0;
            width: 100%;
            background: white;
            z-index: 95;
            border-radius: 16px 16px 0 0;
            display: none;
            flex-direction: column;
            max-height: 60vh;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .popup-header {
            padding: 12px 15px;
            background-color: #f7f8fa;
            display: flex;
            justify-content: space-between;
            border-radius: 16px 16px 0 0;
            border-bottom: 1px solid #eee;
        }

        .popup-list {
            overflow-y: auto;
            padding: 0 15px 15px 15px;
        }

        .popup-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        /* === ç»“ç®—ç¡®è®¤å¼¹çª— (å±…ä¸­) === */
        .confirm-mask {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .confirm-modal {
            background: white;
            width: 85%;
            max-width: 320px;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            animation: popIn 0.2s ease-out;
        }

        @keyframes popIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .confirm-header {
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            border-bottom: 1px solid #eee;
            background-color: #f7f8fa;
        }

        .confirm-body {
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            background: #fff;
        }

        /* æ¨¡æ‹Ÿæ–‡æœ¬åŸŸå¤–è§‚ */
        .order-preview {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.9rem;
            color: #444;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
            line-height: 1.4;
            border: 1px solid #e0e0e0;
        }

        .confirm-footer {
            display: flex;
            border-top: 1px solid #eee;
        }

        .c-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: white;
            font-size: 1rem;
            cursor: pointer;
        }
        
        .c-btn:active { background: #f0f0f0; }

        .c-btn-cancel { color: #666; border-right: 1px solid #eee; }
        .c-btn-ok { color: var(--primary-color); font-weight: bold; }


        /* === Toast æç¤º === */
        .toast {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 3000;
            display: none;
            text-align: center;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>

<div class="header-container">
    <div class="header-title">
        èƒ–å“¥ç¾å‘³å°ç‚’åº— <span class="header-subtitle">/ ç‰©ç¾ä»·å»‰ ç»æµå®æƒ </span>
    </div>
    <div class="search-bar">
        <input type="text" class="search-input" id="search-input" placeholder="è¾“å…¥èœåæœç´¢..." oninput="handleSearch()">
    </div>
</div>

<div class="main-container">
    <div class="sidebar" id="sidebar"></div>
    <div class="content" id="content-scroll">
        <div id="menu-list"></div>
        <div style="height: 60px;"></div> </div>
</div>

<div class="cart-bar" onclick="toggleCart()">
    <div class="cart-icon-wrapper" id="cart-icon-wrap">
        <span class="cart-icon">ğŸ›’</span>
        <div class="cart-badge" id="cart-badge">0</div>
    </div>
    <div style="flex:1">
        <div class="total-price" id="total-price">Â¥0</div>
        <div class="delivery-text">æ— éœ€é…é€è´¹</div>
    </div>
    <button class="btn-checkout" id="btn-checkout" onclick="preCheckout(event)">å»ç»“ç®—</button>
</div>

<div class="modal-mask" id="cart-mask" onclick="toggleCart()"></div>
<div class="cart-popup" id="cart-popup">
    <div class="popup-header">
        <span style="font-size:0.9rem; color:#666;">å·²é€‰å•†å“</span>
        <span style="font-size:0.85rem; color:#999; cursor:pointer;" onclick="clearCart()">æ¸…ç©º</span>
    </div>
    <div class="popup-list" id="cart-list-dom"></div>
</div>

<div class="confirm-mask" id="confirm-mask">
    <div class="confirm-modal">
        <div class="confirm-header">è¯·æ ¸å¯¹è®¢å•</div>
        <div class="confirm-body">
            <div class="order-preview" id="order-preview-text"></div>
        </div>
        <div class="confirm-footer">
            <button class="c-btn c-btn-cancel" onclick="closeConfirmModal()">å–æ¶ˆ</button>
            <button class="c-btn c-btn-ok" onclick="finalCopy()">ç¡®è®¤å¤åˆ¶</button>
        </div>
    </div>
</div>

<div class="toast" id="toast">å·²å¤åˆ¶ï¼<br>è¯·å‘é€ç»™è€æ¿</div>

<script>
    // === 1. æ•°æ®æº (å®Œæ•´èœå“) ===
    const menuData = [
        {
            category: "ç‰¹ä»· / è›‹ç±»",
            id: "cat1",
            emoji: "ğŸ³", 
            bgColor: "#FFF3E0", 
            items: [
                { name: "éº»å©†è±†è…", price: 12 }, { name: "é…¸è¾£åœŸè±†ä¸", price: 12 },
                { name: "é…¸è¾£å¤§ç™½èœ", price: 12 }, { name: "æ‰‹æ’•åŒ…èœ", price: 12 },
                { name: "ç‚’æ—¶è”¬", price: 12 }, { name: "è¥¿çº¢æŸ¿ç‚’è›‹", price: 13, icon: "ğŸ…" },
                { name: "è‹¦ç“œç‚’è›‹", price: 13 }, { name: "é’ç“œç‚’è›‹", price: 13 },
                { name: "é’æ¤’ç‚’è›‹", price: 13 }, { name: "è…ç«¹ç‚’è›‹", price: 13 },
                { name: "éŸ­èœç‚’è›‹", price: 13 }, { name: "å¤–å©†èœç‚’è›‹", price: 13 },
                { name: "ç«è…¿ç‚’è›‹", price: 13 }, { name: "éŸ­é»„ç‚’è›‹", price: 15 },
                { name: "éŸ­èœç…è›‹", price: 12 }, { name: "è‘±èŠ±ç…è›‹", price: 12 },
                { name: "èåœå¹²ç…è›‹", price: 15 }, { name: "è‹¦ç“œç…è›‹", price: 15 }
            ]
        },
        {
            category: "å®¶å¸¸å°ç‚’",
            id: "cat2",
            emoji: "ğŸ¥˜",
            bgColor: "#E8F5E9",
            items: [
                { name: "é‡‘é’ˆè‡ç‚’è‚‰", price: 13 }, { name: "å®¶å¸¸è±†è…", price: 13 },
                { name: "çº¢çƒ§èŒ„å­", price: 13, icon: "ğŸ†" }, { name: "å¹²ç…¸åœŸè±†ç‰‡", price: 13, icon: "ğŸ¥”" },
                { name: "å¹²ç…¸èŠ±èœ", price: 13, icon: "ğŸ¥¦" }, { name: "èŠ¹èœç‚’è‚‰", price: 13 },
                { name: "é±¼é¦™è‚‰ä¸", price: 13 }, { name: "é…¸èœç‚’è‚‰", price: 13 },
                { name: "æ¦¨èœç‚’è‚‰", price: 13 }, { name: "æœ¨è€³ç‚’è‚‰", price: 13 },
                { name: "é…¸è±†è§’è‚‰æ²«", price: 13 }, { name: "æ¦¨èœé¸¡èƒ¸è‚‰", price: 13 },
                { name: "é…¸èœé¸¡èƒ¸è‚‰", price: 13 }, { name: "è’œè‹”é¸¡èƒ¸è‚‰", price: 13 },
                { name: "èƒ¡èåœç‚’è‚‰", price: 13, icon: "ğŸ¥•" }, { name: "é’ç“œç‚’ç«è…¿", price: 13 },
                { name: "é’ç“œç‚’è‚‰", price: 13 }, { name: "é’èœè‚‰ç‰‡", price: 13 },
                { name: "èŠ¹èœé¦™å¹²è‚‰ä¸", price: 13 }, { name: "åœŸè±†ä¸ç‚’è‚‰", price: 13 }
            ]
        },
        {
            category: "é¸¡æ‚ / çŒªæ‚",
            id: "cat3",
            emoji: "ğŸ—",
            bgColor: "#FFEBEE",
            items: [
                { name: "çº¢çƒ§é±¼å—", price: 15, icon: "ğŸŸ" }, { name: "é‡‘é’ˆè‡ç‚’é¸¡è‚‰", price: 15 },
                { name: "é¦™è‡ç‚’é¸¡è‚‰", price: 15, icon: "ğŸ„" }, { name: "æ´‹è‘±ç‚’é¸¡è‚‰", price: 15, icon: "ğŸ§…" },
                { name: "åœŸè±†ç‚’é¸¡è‚‰", price: 15 }, { name: "é’æ¤’ç‚’é¸¡è‚‰", price: 15 },
                { name: "é…¸èœé¸¡æ‚", price: 15 }, { name: "é…¸è¾£é¸¡æ‚", price: 15 },
                { name: "çˆ†ç‚’é¸¡æ‚", price: 15 }, { name: "çˆ†ç‚’çŒªè€³", price: 15, icon: "ğŸ‘‚" },
                { name: "çˆ†ç‚’çŒªè‚", price: 15 }, { name: "çˆ†ç‚’çŒªæ‚", price: 15 },
                { name: "é…¸è¾£çŒªè‚", price: 15 }, { name: "çƒŸç¬‹ç‚’äº”èŠ±è‚‰", price: 15 }
            ]
        },
        {
            category: "è…Šå‘³ / å›é”…",
            id: "cat4",
            emoji: "ğŸ¥“",
            bgColor: "#FFF8E1",
            items: [
                { name: "å››å­£è±†ç‚’è…Šè‚‰", price: 15 }, { name: "è´ç¬‹ç‚’è…Šè‚‰", price: 15 },
                { name: "å…°è±†ç‚’è…Šè‚‰", price: 15 }, { name: "è’œè‹”ç‚’è…Šè‚‰", price: 15 },
                { name: "é’æ¤’ç‚’è…Šè‚‰", price: 15 }, { name: "æ´‹è‘±ç‚’è…Šè‚‰", price: 15 },
                { name: "é¦™å¹²ç‚’è…Šè‚‰", price: 15 }, { name: "å°–æ¤’å›é”…è‚‰", price: 15, icon: "ğŸŒ¶ï¸" },
                { name: "è¥¿å…°èŠ±äº”èŠ±è‚‰", price: 15 }, { name: "èŠ±èœäº”èŠ±è‚‰", price: 15 },
                { name: "åœŸè±†å›é”…è‚‰", price: 15 }, { name: "é¦™å¹²å›é”…è‚‰", price: 15 },
                { name: "è…ç«¹å›é”…è‚‰", price: 15 }, { name: "æ²¹è±†è…å›é”…è‚‰", price: 15 },
                { name: "å››å­£è±†å›é”…è‚‰", price: 15 }, { name: "è’œè‹—å›é”…è‚‰", price: 15 }
            ]
        },
        {
            category: "ç‰¹è‰²å°ç‚’",
            id: "cat5",
            emoji: "ğŸ²",
            bgColor: "#E3F2FD",
            items: [
                { name: "å°ç‚’è‚‰", price: 15 }, { name: "ä¸ç“œç‚’è‚‰", price: 15 },
                { name: "è²è—•ç‚’è‚‰", price: 15 }, { name: "å’¸é±¼èŒ„å­", price: 15 },
                { name: "è±†è§’ç‚’è‚‰", price: 15 }, { name: "èŒ„å­è±†è§’", price: 15 },
                { name: "è´ç¬‹ç‚’è‚‰", price: 15 }, { name: "é’æ¤’ç‚’è‚‰å·", price: 15 },
                { name: "èŠ¹èœç‚’è‚‰å·", price: 15 }, { name: "è…ç«¹ç„–é¸¡", price: 15 },
                { name: "å†œå®¶ä¸€ç¢—é¦™", price: 15 }, { name: "çº¢çƒ§æ—¥æœ¬è±†è…", price: 15 },
                { name: "è™çš®å°–æ¤’", price: 15 }, { name: "å‡‰ç“œç‚’è‚‰", price: 15 },
                { name: "é¦™è‡ç‚’è‚‰", price: 15 }, { name: "åŒ…èœå›é”…è‚‰", price: 15 },
                { name: "è·å…°è±†ç‚’è‚‰", price: 15 }
            ]
        },
        {
            category: "è‚¥è‚  / ç‰›è‚‰",
            id: "cat6",
            emoji: "ğŸ‚",
            bgColor: "#F3E5F5",
            items: [
                { name: "é…¸èœå¤§è‚ ", price: 18 }, { name: "é…¸è¾£è‚¥è‚ ", price: 18 },
                { name: "çˆ†ç‚’è‚¥è‚ ", price: 18 }, { name: "é’æ¤’ç‚’ç‰›è‚‰", price: 18 },
                { name: "èŠ¥å…°ç‚’ç‰›è‚‰", price: 18 }, { name: "å‡‰ç“œç‚’ç‰›è‚‰", price: 18 },
                { name: "è·å…°è±†ç‚’ç‰›è‚‰", price: 18 }, { name: "é‡‘é’ˆè‡ç‚’ç‰›è‚‰", price: 18 },
                { name: "å°ç‚’ç‰›è‚‰", price: 20 }, { name: "å‡‰æ‹Œçš®è›‹", price: 15, icon: "ğŸ¥š" },
                { name: "å‡‰æ‹Œé’ç“œ", price: 15, icon: "ğŸ¥’" }, { name: "å‡‰æ‹ŒçŒªè€³", price: 20 }
            ]
        },
        {
            category: "æ‹›ç‰Œç¡¬èœ",
            id: "cat7",
            emoji: "ğŸ”¥",
            bgColor: "#FFEBEE",
            items: [
                { name: "å®«ä¿é¸¡ä¸", price: 17 }, { name: "è¾£å­é¸¡", price: 18, icon: "ğŸ”" },
                { name: "é…¸èœç„–é±¼å—", price: 20, icon: "ğŸŸ" }, { name: "è…ç«¹ç„–é±¼å—", price: 20, icon: "ğŸŸ" },
                { name: "å§œè‘±ç‚’é¸¡", price: 20 }, { name: "é…¸èœé±¼", price: 25, icon: "ğŸŸ" },
                { name: "æ°´ç…®é±¼", price: 25, icon: "ğŸŒ¶ï¸" }, { name: "æ°´ç…®è‚‰ç‰‡", price: 25, icon: "ğŸ¥©" },
                { name: "çº¢çƒ§é±¼", price: 28, icon: "ğŸŸ" }, { name: "æ°´ç…®ç‰›è‚‰", price: 30, icon: "ğŸ‚" },
                { name: "é…¸ç”œæ’éª¨", price: 30, icon: "ğŸ¦´" }, { name: "çº¢çƒ§æ’éª¨", price: 30, icon: "ğŸ¦´" }
            ]
        },
        {
            category: "ç ‚é”…ç…²ç±»",
            id: "cat8",
            emoji: "ğŸ¥£",
            bgColor: "#EFEBE9",
            items: [
                { name: "æ‚è‡æ’éª¨ç…²", price: 18 }, { name: "èŠ±èœäº”èŠ±è‚‰ç…²", price: 15 },
                { name: "èŠ±èœæ’éª¨ç…²", price: 18 }, { name: "æ˜¥èœäº”èŠ±è‚‰ç…²", price: 15 },
                { name: "æ˜¥èœæ’éª¨ç…²", price: 18 }, { name: "è‹¦ç“œäº”èŠ±è‚‰ç…²", price: 15 },
                { name: "è‹¦ç“œæ’éª¨ç…²", price: 18 }, { name: "è…ç«¹äº”èŠ±è‚‰ç…²", price: 15 },
                { name: "è…ç«¹æ’éª¨ç…²", price: 18 }, { name: "é…¸èœå¤§è‚ ç…²", price: 18 },
                { name: "é…¸èœæ’éª¨ç…²", price: 18 }, { name: "æ—¥æœ¬è±†è…ç…²", price: 18 },
                { name: "èŒ„å­ç…²", price: 18 }, { name: "åœŸè±†ç‰›è…©ç…²", price: 20 },
                { name: "è…ç«¹ç‰›è…©ç…²", price: 20 }, { name: "æ²¹è±†è…ç‰›è…©ç…²", price: 20 }
            ]
        },
        {
            category: "ä¸»é£Ÿ / æ±¤ç±»",
            id: "cat9",
            emoji: "ğŸš",
            bgColor: "#F1F8E9",
            items: [
                { name: "ç‰›è‚‰ç‚’é¥­", price: 15 }, { name: "å¹²ç‚’ç‰›æ²³", price: 15, icon: "ğŸœ" },
                { name: "æ¹¿ç‚’ç‰›æ²³", price: 15, icon: "ğŸœ" }, { name: "è›‹è‚‰ç‚’é¥­", price: 12 },
                { name: "ç‚’æ²³ç²‰(æ±¤)", price: 12, icon: "ğŸœ" }, { name: "ç‚’ç±³ç²‰(æ±¤)", price: 12, icon: "ğŸœ" },
                { name: "è¥¿çº¢æŸ¿è›‹æ±¤", price: 12 }, { name: "ç´«èœè›‹èŠ±æ±¤", price: 12 },
                { name: "çŒªæ‚æ±¤", price: 15 }, { name: "é±¼å¤´è±†è…æ±¤", price: 15 },
                { name: "æ¸æå¶ç˜¦è‚‰æ±¤", price: 15 }
            ]
        }
    ];

    let cart = {}; // { itemId: num }
    let idMap = {}; // id -> item
    let globalId = 1;

    // é¢„å¤„ç†æ•°æ®ï¼šåˆ†é…IDå’Œå›¾æ ‡
    menuData.forEach(cat => {
        cat.items.forEach(item => {
            item.id = globalId++;
            item.catId = cat.id;
            if(!item.icon) item.icon = cat.emoji;
            item.bgColor = cat.bgColor; 
            idMap[item.id] = item;
        });
    });

    let isNavClick = false; // ç”¨äºæ§åˆ¶æ»šåŠ¨ç›‘å¬

    // === 2. åˆå§‹åŒ– ===
    function init() {
        renderSidebar();
        renderMenu(menuData);
        document.getElementById('content-scroll').addEventListener('scroll', onScroll);
    }

    // æ¸²æŸ“å·¦ä¾§
    function renderSidebar() {
        const sidebar = document.getElementById('sidebar');
        let html = '';
        menuData.forEach((cat, idx) => {
            const active = idx === 0 ? 'active' : '';
            html += `<div class="nav-item ${active}" id="nav-${cat.id}" onclick="clickNav('${cat.id}')">
                ${cat.category.split('/')[0]}
            </div>`;
        });
        sidebar.innerHTML = html;
    }

    // æ¸²æŸ“å³ä¾§
    function renderMenu(data) {
        const list = document.getElementById('menu-list');
        let html = '';

        data.forEach(cat => {
            if(cat.items.length === 0) return;

            html += `<div class="category-header" id="header-${cat.id}">${cat.category}</div>`;
            html += `<div class="category-group" id="group-${cat.id}">`;
            
            cat.items.forEach(item => {
                const count = cart[item.id] || 0;
                html += `
                    <div class="dish-item">
                        <div class="dish-img-box" style="background-color: ${item.bgColor}">
                            ${item.icon}
                        </div>
                        <div class="dish-info">
                            <div class="dish-name">${item.name}</div>
                            <div class="dish-tag">è€æ¿æ¨è</div>
                            <div class="dish-action">
                                <div class="dish-price"><span>Â¥</span>${item.price}</div>
                                <div class="qty-control">
                                    <div class="btn-minus" id="minus-${item.id}" 
                                         style="display:${count>0?'flex':'none'}"
                                         onclick="updateCart(${item.id}, -1)">-</div>
                                    <div class="qty-num" id="num-${item.id}"
                                         style="display:${count>0?'block':'none'}">${count}</div>
                                    <div class="btn-add" onclick="updateCart(${item.id}, 1)">+</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
        });

        if(!html) html = '<div style="text-align:center;padding:50px;color:#999">æœªæ‰¾åˆ°ç›¸å…³èœå“</div>';
        list.innerHTML = html;
    }

    // === 3. åŸºç¡€äº¤äº’ ===
    function clickNav(catId) {
        isNavClick = true;
        document.querySelectorAll('.nav-item').forEach(d => d.classList.remove('active'));
        document.getElementById('nav-'+catId).classList.add('active');
        const target = document.getElementById('header-'+catId);
        if(target) target.scrollIntoView({behavior: "smooth"});
        setTimeout(() => isNavClick = false, 600);
    }

    function onScroll() {
        if(isNavClick) return;
        const container = document.getElementById('content-scroll');
        const headers = document.querySelectorAll('.category-header');
        let currentId = '';
        headers.forEach(h => {
            if(h.offsetTop - container.offsetTop <= container.scrollTop + 50) {
                currentId = h.id.replace('header-', '');
            }
        });
        if(currentId) {
            document.querySelectorAll('.nav-item').forEach(d => d.classList.remove('active'));
            const nav = document.getElementById('nav-'+currentId);
            if(nav) {
                nav.classList.add('active');
                nav.scrollIntoView({behavior:"smooth", block:"center"});
            }
        }
    }

    function handleSearch() {
        const key = document.getElementById('search-input').value.trim();
        if(!key) {
            renderMenu(menuData);
            restoreUI();
            return;
        }
        const filtered = menuData.map(cat => ({
            ...cat,
            items: cat.items.filter(i => i.name.includes(key))
        })).filter(c => c.items.length > 0);
        renderMenu(filtered);
        restoreUI();
    }

    function restoreUI() {
        for(let id in cart) {
            updateSingleUI(id, cart[id]);
        }
    }

    // === 4. è´­ç‰©è½¦é€»è¾‘ ===
    function updateCart(id, delta) {
        if(!cart[id]) cart[id] = 0;
        cart[id] += delta;
        if(cart[id] <= 0) delete cart[id];
        
        updateSingleUI(id, cart[id] || 0);
        calcTotal();

        // å¼¹çª—å®æ—¶æ›´æ–°
        if(document.getElementById('cart-mask').style.display === 'block') {
            renderPopupList();
            if(Object.keys(cart).length === 0) toggleCart();
        }
        // ç¡®è®¤å¼¹çª—å¦‚æœå¼€ç€ï¼Œä¹Ÿè¦å…³æ‰ï¼ˆé˜²æ­¢ä¿®æ”¹äº†æ•°é‡åå¤åˆ¶å†…å®¹ä¸å¯¹ï¼‰
        if(document.getElementById('confirm-mask').style.display === 'flex') {
             closeConfirmModal();
        }
    }

    function updateSingleUI(id, count) {
        const minus = document.getElementById('minus-'+id);
        const num = document.getElementById('num-'+id);
        if(minus && num) {
            minus.style.display = count > 0 ? 'flex' : 'none';
            num.style.display = count > 0 ? 'block' : 'none';
            num.innerText = count;
        }
    }

    function calcTotal() {
        let total = 0;
        let count = 0;
        for(let id in cart) {
            total += idMap[id].price * cart[id];
            count += cart[id];
        }
        document.getElementById('total-price').innerText = 'Â¥' + total;
        document.getElementById('cart-badge').innerText = count;
        
        const wrap = document.getElementById('cart-icon-wrap');
        const badge = document.getElementById('cart-badge');
        const btn = document.getElementById('btn-checkout');

        if(count > 0) {
            wrap.classList.add('active');
            badge.style.display = 'flex';
            btn.classList.add('active');
            btn.innerText = 'å»ç»“ç®—';
        } else {
            wrap.classList.remove('active');
            badge.style.display = 'none';
            btn.classList.remove('active');
            btn.innerText = 'æœªé€‰è´­';
        }
    }

    function toggleCart() {
        if(Object.keys(cart).length === 0) return;
        const mask = document.getElementById('cart-mask');
        const popup = document.getElementById('cart-popup');
        
        if(mask.style.display === 'block') {
            mask.style.display = 'none';
            popup.style.display = 'none';
        } else {
            renderPopupList();
            mask.style.display = 'block';
            popup.style.display = 'flex';
        }
    }

    function renderPopupList() {
        const dom = document.getElementById('cart-list-dom');
        let html = '';
        for(let id in cart) {
            const item = idMap[id];
            html += `
                <div class="popup-item">
                    <div style="flex:1">
                        <div style="font-weight:bold">${item.name}</div>
                        <div style="font-size:0.8rem;color:#999">Â¥${item.price}</div>
                    </div>
                    <div class="qty-control">
                        <div class="btn-minus" onclick="updateCart(${item.id}, -1)">-</div>
                        <div class="qty-num">${cart[id]}</div>
                        <div class="btn-add" onclick="updateCart(${item.id}, 1)">+</div>
                    </div>
                </div>
            `;
        }
        dom.innerHTML = html;
    }

    function clearCart() {
        if(confirm("æ¸…ç©ºè´­ç‰©è½¦ï¼Ÿ")) {
            cart = {};
            calcTotal();
            renderMenu(menuData);
            toggleCart();
        }
    }

    // === 5. ç»“ç®—ç¡®è®¤é€»è¾‘ (æ–°åŠŸèƒ½) ===
    
    let currentOrderText = "";

    // ç‚¹å‡»â€œå»ç»“ç®—â€
    function preCheckout(e) {
        e.stopPropagation();
        if(Object.keys(cart).length === 0) return;

        // ç”Ÿæˆè®¢å•æ–‡æœ¬
        let text = "ã€èƒ–å“¥å°ç‚’ è®¢å•ã€‘\n";
        let sum = 0;
        let totalCount = 0;
        
        for(let id in cart) {
            const item = idMap[id];
            const sub = item.price * cart[id];
            sum += sub;
            totalCount += cart[id];
            text += `${item.name} x${cart[id]} = ${sub}\n`;
        }
        text += `---------------\nå…± ${totalCount} ä»½ï¼Œæ€»è®¡ï¼šÂ¥${sum}`;

        currentOrderText = text;

        // æ˜¾ç¤ºç¡®è®¤å¼¹çª—
        document.getElementById('order-preview-text').innerText = text;
        document.getElementById('confirm-mask').style.display = 'flex';
    }

    // å…³é—­ç¡®è®¤å¼¹çª—
    function closeConfirmModal() {
        document.getElementById('confirm-mask').style.display = 'none';
    }

    // æœ€ç»ˆå¤åˆ¶
    function finalCopy() {
        copyToClip(currentOrderText);
        closeConfirmModal();
        
        // å¯é€‰ï¼šå¤åˆ¶æˆåŠŸåæ˜¯å¦å…³é—­åº•éƒ¨çš„è´­ç‰©è½¦è¯¦æƒ…ï¼Ÿ
        const cartMask = document.getElementById('cart-mask');
        if(cartMask.style.display === 'block') toggleCart();
    }

    function copyToClip(content) {
        const aux = document.createElement("textarea"); 
        aux.value = content; 
        document.body.appendChild(aux); 
        aux.select(); 
        document.execCommand("copy"); 
        document.body.removeChild(aux);
        
        const t = document.getElementById('toast');
        t.style.display = 'block';
        setTimeout(()=>t.style.display='none', 2500);
    }

    init();
</script>

</body>
</html>